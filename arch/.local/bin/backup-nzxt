#!/bin/bash

# Set environment variables
export RESTIC_REPOSITORY="/mnt/16tbinternal/restic"
export RESTIC_PASSWORD_FILE="/home/aleksozolins/.local/share/restic/backup_password.txt"

# Backup root directory excluding /mnt
sudo -E restic backup / \
  --exclude=/mnt \
  --exclude=/proc \
  --exclude=/sys \
  --exclude=/dev \
  --exclude=/run \
  --exclude=/tmp \
  --exclude=/lost+found \
  --exclude=/var/cache \
  --exclude=/var/tmp \
  --exclude=/home/aleksozolins/Dropbox/.dropbox.cache \
  --exclude=/home/aleksozolins/.cache \
  --tag root-backup --repo "$RESTIC_REPOSITORY"

# Backup /mnt/unas-main
sudo -E restic backup /mnt/unas-main --tag unas-main-backup --repo "$RESTIC_REPOSITORY"
